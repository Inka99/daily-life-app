<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>待办事项 - 每日生活</title>
    <link rel="stylesheet" href="../css/main.css">
    <link rel="stylesheet" href="../css/components.css">
    <link rel="stylesheet" href="../css/responsive.css">
</head>
<body>
    <div id="app" class="app">
        <!-- 顶部导航 -->
        <header class="header">
            <div class="header-content">
                <div class="header-left">
                    <button class="back-button" onclick="goBack()">
                        <svg class="icon" viewBox="0 0 24 24">
                            <path d="M20 11H7.83l5.59-5.59L12 4l-8 8 8 8 1.41-1.41L7.83 13H20v-2z"/>
                        </svg>
                    </button>
                    <h1 class="page-title">待办事项</h1>
                </div>
                <div class="header-right">
                    <button class="filter-button" id="filterButton">
                        <svg class="icon" viewBox="0 0 24 24">
                            <path d="M10 18h4v-2h-4v2zM3 6v2h18V6H3zm3 7h12v-2H6v2z"/>
                        </svg>
                    </button>
                </div>
            </div>
        </header>

        <!-- 主内容区域 -->
        <main class="main-content">
            <!-- 待办统计 -->
            <section class="stats-section">
                <div class="stats-grid">
                    <div class="stat-item">
                        <span class="stat-number" id="totalTodos">0</span>
                        <span class="stat-label">总计</span>
                    </div>
                    <div class="stat-item">
                        <span class="stat-number" id="pendingTodos">0</span>
                        <span class="stat-label">待完成</span>
                    </div>
                    <div class="stat-item">
                        <span class="stat-number" id="completedTodos">0</span>
                        <span class="stat-label">已完成</span>
                    </div>
                    <div class="stat-item">
                        <span class="stat-number" id="completionRate">0%</span>
                        <span class="stat-label">完成率</span>
                    </div>
                </div>
            </section>

            <!-- 快速添加 -->
            <section class="quick-add-section">
                <div class="quick-add-form">
                    <input type="text" class="quick-add-input" id="quickAddInput" placeholder="添加新的待办事项..." maxlength="100">
                    <button class="quick-add-button" onclick="quickAddTodo()">
                        <svg class="icon" viewBox="0 0 24 24">
                            <path d="M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6v2z"/>
                        </svg>
                    </button>
                </div>
            </section>

            <!-- 筛选标签 -->
            <section class="filter-section" id="filterSection" style="display: none;">
                <div class="filter-tabs">
                    <button class="filter-tab active" data-filter="all">全部</button>
                    <button class="filter-tab" data-filter="today">今日</button>
                    <button class="filter-tab" data-filter="pending">待完成</button>
                    <button class="filter-tab" data-filter="completed">已完成</button>
                </div>
                <div class="filter-categories">
                    <button class="category-btn active" data-category="all">全部分类</button>
                    <button class="category-btn" data-category="work">工作</button>
                    <button class="category-btn" data-category="life">生活</button>
                    <button class="category-btn" data-category="study">学习</button>
                    <button class="category-btn" data-category="health">健康</button>
                </div>
            </section>

            <!-- 待办列表 -->
            <section class="todos-section">
                <div class="todos-container" id="todosContainer">
                    <!-- 待办事项将在这里动态生成 -->
                    <div class="empty-state" id="emptyState">
                        <svg class="empty-icon" viewBox="0 0 24 24">
                            <path d="M9 11H7v2h2v-2zm4 0h-2v2h2v-2zm4 0h-2v2h2v-2zm2-7h-1V2h-2v2H8V2H6v2H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2zm0 16H5V9h14v11z"/>
                        </svg>
                        <p class="empty-text">暂无待办事项</p>
                        <p class="empty-subtext">点击上方输入框添加新的待办事项</p>
                    </div>
                </div>
            </section>
        </main>

        <!-- 浮动添加按钮 -->
        <button class="fab-button" onclick="showAddTodoModal()">
            <svg class="icon" viewBox="0 0 24 24">
                <path d="M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6v2z"/>
            </svg>
        </button>

        <!-- 添加待办弹窗 -->
        <div class="modal-overlay" id="addTodoModal">
            <div class="modal">
                <div class="modal-header">
                    <h3 class="modal-title">添加待办事项</h3>
                    <button class="modal-close" onclick="closeModal('addTodoModal')">×</button>
                </div>
                <div class="modal-content">
                    <form id="addTodoForm" class="todo-form">
                        <div class="form-group">
                            <label class="form-label">任务标题</label>
                            <input type="text" class="form-input" id="todoTitle" placeholder="输入任务标题..." required maxlength="100">
                        </div>
                        <div class="form-group">
                            <label class="form-label">详细描述</label>
                            <textarea class="form-textarea" id="todoDescription" placeholder="输入任务详细描述（可选）" maxlength="500"></textarea>
                        </div>
                        <div class="form-group">
                            <label class="form-label">优先级</label>
                            <div class="priority-options">
                                <label class="priority-option">
                                    <input type="radio" name="priority" value="high">
                                    <span class="priority-badge high">高</span>
                                </label>
                                <label class="priority-option">
                                    <input type="radio" name="priority" value="medium" checked>
                                    <span class="priority-badge medium">中</span>
                                </label>
                                <label class="priority-option">
                                    <input type="radio" name="priority" value="low">
                                    <span class="priority-badge low">低</span>
                                </label>
                            </div>
                        </div>
                        <div class="form-group">
                            <label class="form-label">分类</label>
                            <select class="form-select" id="todoCategory">
                                <option value="work">工作</option>
                                <option value="life">生活</option>
                                <option value="study">学习</option>
                                <option value="health">健康</option>
                                <option value="other">其他</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label class="form-label">截止时间</label>
                            <input type="datetime-local" class="form-input" id="todoDueDate">
                        </div>
                        <div class="form-actions">
                            <button type="button" class="btn btn-secondary" onclick="closeModal('addTodoModal')">取消</button>
                            <button type="submit" class="btn btn-primary">添加任务</button>
                        </div>
                    </form>
                </div>
            </div>
        </div>

        <!-- 编辑待办弹窗 -->
        <div class="modal-overlay" id="editTodoModal">
            <div class="modal">
                <div class="modal-header">
                    <h3 class="modal-title">编辑待办事项</h3>
                    <button class="modal-close" onclick="closeModal('editTodoModal')">×</button>
                </div>
                <div class="modal-content">
                    <form id="editTodoForm" class="todo-form">
                        <input type="hidden" id="editTodoId">
                        <div class="form-group">
                            <label class="form-label">任务标题</label>
                            <input type="text" class="form-input" id="editTodoTitle" required maxlength="100">
                        </div>
                        <div class="form-group">
                            <label class="form-label">详细描述</label>
                            <textarea class="form-textarea" id="editTodoDescription" maxlength="500"></textarea>
                        </div>
                        <div class="form-group">
                            <label class="form-label">状态</label>
                            <select class="form-select" id="editTodoStatus">
                                <option value="pending">待处理</option>
                                <option value="progress">进行中</option>
                                <option value="completed">已完成</option>
                                <option value="cancelled">已取消</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label class="form-label">优先级</label>
                            <div class="priority-options">
                                <label class="priority-option">
                                    <input type="radio" name="editPriority" value="high">
                                    <span class="priority-badge high">高</span>
                                </label>
                                <label class="priority-option">
                                    <input type="radio" name="editPriority" value="medium">
                                    <span class="priority-badge medium">中</span>
                                </label>
                                <label class="priority-option">
                                    <input type="radio" name="editPriority" value="low">
                                    <span class="priority-badge low">低</span>
                                </label>
                            </div>
                        </div>
                        <div class="form-group">
                            <label class="form-label">分类</label>
                            <select class="form-select" id="editTodoCategory">
                                <option value="work">工作</option>
                                <option value="life">生活</option>
                                <option value="study">学习</option>
                                <option value="health">健康</option>
                                <option value="other">其他</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label class="form-label">截止时间</label>
                            <input type="datetime-local" class="form-input" id="editTodoDueDate">
                        </div>
                        <div class="form-actions">
                            <button type="button" class="btn btn-danger" onclick="deleteTodo()">删除</button>
                            <div class="form-actions-right">
                                <button type="button" class="btn btn-secondary" onclick="closeModal('editTodoModal')">取消</button>
                                <button type="submit" class="btn btn-primary">保存</button>
                            </div>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>

    <script src="../js/app.js"></script>
    <script src="../js/storage.js"></script>
    <script src="../js/todos.js"></script>
</body>
</html>